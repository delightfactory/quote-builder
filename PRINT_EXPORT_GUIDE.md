# 🖨️ دليل الطباعة والتصدير - Print & Export Guide

## ✅ التحسينات المطبقة

### 1️⃣ تحويل جميع الأرقام للإنجليزية

#### **قبل التحسين:**
```
١٢٣,٤٥٦.٧٨ ج.م
```

#### **بعد التحسين:**
```
123,456.78 ج.م
```

#### **التطبيق:**
- ✅ جميع الأسعار في بطاقات المنتجات
- ✅ جميع الأرقام في صفحة العرض
- ✅ جميع الأرقام في معاينة الطباعة
- ✅ الكميات والأعداد
- ✅ النسب المئوية (الهوامش)

#### **الدوال المستخدمة:**
```javascript
// formatCurrency: للأسعار مع منزلتين عشريتين
formatCurrency(1234.5) → "1,234.50"

// formatNumber: للأعداد الصحيحة
formatNumber(1234) → "1,234"
```

---

### 2️⃣ نظام طباعة احترافي

#### **A. Header احترافي للطباعة**

```
╔═══════════════════════════════════════════╗
║  عرض سعر / Quotation                     ║
║  Quote Builder Pro                        ║
║  رقم العرض: Q20251004-123                ║
╚═══════════════════════════════════════════╝
```

**المميزات:**
- رقم عرض تلقائي فريد بصيغة: `Q{Year}{Month}{Day}-{Random}`
- تاريخ بالصيغة الدولية (DD/MM/YYYY)
- تصميم gradient احترافي
- منطقة شعار (يمكن إضافة اللوجو لاحقاً)

#### **B. معلومات العرض**

| الحقل | الوصف |
|------|-------|
| **رقم العرض** | رقم فريد يُنشأ تلقائياً |
| **التاريخ** | تاريخ إنشاء العرض |
| **اسم العرض** | وصف العرض |
| **اسم العميل** | اسم الجهة المستفيدة |

#### **C. جدول المنتجات**

```
┌─────┬──────────┬────────────────┬────────┬───────────┬─────────────┐
│  #  │ الكود    │ اسم المنتج     │ الكمية │ سعر الوحدة │ الإجمالي    │
├─────┼──────────┼────────────────┼────────┼───────────┼─────────────┤
│  1  │ 106      │ pistol 700     │   2    │  75.00    │  150.00     │
│  2  │ 108      │ MAX EFFECT...  │   3    │  200.00   │  600.00     │
└─────┴──────────┴────────────────┴────────┴───────────┴─────────────┘
```

**المميزات:**
- ترقيم تلقائي
- عرض الكود بخط monospace
- محاذاة احترافية
- حدود واضحة

#### **D. ملخص مالي احترافي**

```
┌───────────────────────────────────────┐
│ عدد الأصناف:         5 صنف          │
│ إجمالي الكمية:      15 قطعة         │
├───────────────────────────────────────┤
│ إجمالي التكلفة:    1,250.00 ج.م    │🟠
│ هامش الربح:         30.00%          │🔵
│ قيمة الربح:         535.71 ج.م     │💙
├═══════════════════════════════════════┤
│ الإجمالي النهائي:  1,785.71 ج.م    │🟢
└───────────────────────────────────────┘
```

---

### 3️⃣ إعدادات الطباعة المتقدمة

#### **Page Setup**
```css
@page {
  size: A4;              /* حجم الورق */
  margin: 1.5cm 1cm;     /* هوامش الصفحة */
}
```

#### **Typography**
- **العناوين الرئيسية**: 24pt
- **العناوين الفرعية**: 18pt
- **العناوين الثانوية**: 14pt
- **النص الأساسي**: 11pt
- **Line Height**: 1.3

#### **Colors**
```css
/* الألوان محفوظة في الطباعة */
print-color-adjust: exact;
-webkit-print-color-adjust: exact;
```

#### **Page Breaks**
- ❌ لا تقطع الجداول
- ❌ لا تقطع العناصر في Grid
- ❌ لا تقطع الملخص المالي
- ✅ Header يظهر في كل صفحة

#### **Backgrounds & Borders**
- ✅ الخلفيات الملونة محفوظة
- ✅ الحدود واضحة (1px solid)
- ✅ الـ gradients محفوظة

---

### 4️⃣ نظام التصدير

#### **A. تصدير إلى PDF**

**الطريقة:**
1. اضغط "طباعة / حفظ PDF"
2. في نافذة الطباعة، اختر "Save as PDF"
3. اختر المسار واحفظ

**المميزات:**
- ✅ جودة عالية
- ✅ محفوظ الألوان
- ✅ قابل للبحث (searchable)
- ✅ حجم ملف صغير

#### **B. تصدير إلى Excel/CSV**

**الطريقة:**
1. اضغط "تصدير Excel"
2. سيتم تحميل ملف CSV تلقائياً

**محتوى الملف:**
```csv
Product Code,Product Name,Quantity,Unit Price,Total Price
106,pistol 700,2,75.00,150.00
108,MAX EFFECT 1 L NEW,3,200.00,600.00

,,,Total Cost,425.00
,,,,Final Price,607.14
,,,,Profit,182.14
,,,,Margin,30.00%
```

**استخدام الملف:**
- افتح بـ Excel
- افتح بـ Google Sheets
- استورد إلى نظام محاسبة
- عمل تحليلات إضافية

---

### 5️⃣ أفضل الممارسات للطباعة

#### **A. إعدادات الطابعة**

**توصيات:**
```
الورق:        A4
الاتجاه:      عمودي (Portrait)
الهوامش:      عادية (Normal)
الجودة:       عالية (High Quality)
الألوان:      ملون (Color)
```

#### **B. الطباعة إلى PDF**

**Google Chrome:**
1. Ctrl+P
2. Destination: Save as PDF
3. Layout: Portrait
4. Paper size: A4
5. Margins: Default
6. Options: 
   - ✅ Background graphics
   - ✅ Headers and footers

**Microsoft Edge:**
نفس الإعدادات أعلاه

#### **C. الطباعة الفعلية**

**للطباعة على ورق:**
- استخدم ورق A4 أبيض
- جودة طباعة: عالية
- الألوان: اختيارية (يعمل بالأبيض والأسود أيضاً)
- الحبر: تأكد من كفاية الحبر

---

### 6️⃣ استكشاف الأخطاء

#### **المشكلة: الألوان لا تطبع**
**الحل:**
```
✅ في إعدادات الطباعة:
   - فعّل "Background graphics"
   - اختر "Color" بدلاً من "Black & White"
```

#### **المشكلة: الصفحة مقطوعة**
**الحل:**
```
✅ اضبط Scale إلى "Fit to page"
✅ تأكد من اختيار A4
✅ جرب تغيير الهوامش
```

#### **المشكلة: النصوص صغيرة جداً**
**الحل:**
```
✅ اضبط Scale إلى 110% أو 120%
✅ أو غيّر حجم الورق إلى A4
```

#### **المشكلة: CSV لا يفتح بشكل صحيح**
**الحل:**
```
✅ افتح Excel أولاً
✅ File → Open → اختر الملف
✅ حدد encoding: UTF-8
```

---

### 7️⃣ مقارنة قبل وبعد

#### **قبل التحسينات**
```
❌ أرقام عربية (١٢٣,٤٥٦)
❌ طباعة بسيطة بدون تنسيق
❌ لا يوجد رقم عرض
❌ لا يوجد تصدير
❌ الألوان تختفي عند الطباعة
❌ النصوص غير واضحة
```

#### **بعد التحسينات**
```
✅ أرقام إنجليزية (123,456)
✅ طباعة احترافية كاملة
✅ رقم عرض تلقائي فريد
✅ تصدير PDF + Excel/CSV
✅ الألوان محفوظة تماماً
✅ Typography احترافي
✅ Page breaks ذكية
✅ Headers ثابتة
✅ Footer مع معلومات إضافية
```

---

### 8️⃣ نصائح متقدمة

#### **للشركات:**
```
1. أضف شعار الشركة في منطقة Header
2. خصص الـ Footer بمعلومات الاتصال
3. أضف رقم السجل التجاري
4. أضف الرقم الضريبي
```

#### **للمحاسبين:**
```
1. صدّر إلى CSV للتحليل
2. استورد البيانات إلى Excel
3. اعمل PivotTables للتقارير
4. اربط مع أنظمة ERP
```

#### **للمبيعات:**
```
1. احفظ PDF لكل عميل
2. أرسل بالإيميل مباشرة
3. اطبع نسخة ورقية للأرشيف
4. راجع الأرقام قبل الإرسال
```

---

### 9️⃣ الميزات الإضافية

#### **رقم العرض الذكي**
```javascript
// Format: Q{YYYY}{MM}{DD}-{XXX}
Q20251004-123

// حيث:
YYYY = السنة (2025)
MM   = الشهر (10)
DD   = اليوم (04)
XXX  = رقم عشوائي (123)
```

#### **التواريخ**
```
❌ قديم: ٤ أكتوبر ٢٠٢٥
✅ جديد: 04/10/2025
```

#### **الأعداد**
```
❌ قديم: ١٢٣٬٤٥٦٫٧٨
✅ جديد: 123,456.78
```

---

### 🔟 الخلاصة

#### **ما تم تحسينه:**
1. ✅ **100%** من الأرقام بالإنجليزية
2. ✅ نظام طباعة احترافي كامل
3. ✅ تصدير متعدد الصيغ (PDF + CSV)
4. ✅ رقم عرض فريد تلقائي
5. ✅ تنسيق طباعة متقدم
6. ✅ ألوان محفوظة
7. ✅ Typography احترافي
8. ✅ Page management ذكي

#### **النتيجة:**
```
عروض أسعار احترافية جاهزة للطباعة والتصدير
بجودة عالية وتنسيق مثالي للعملاء
```

---

**تم التطوير بواسطة Quote Builder Pro** 🎉
**جميع الحقوق محفوظة © 2025**
